<div class="edit-tpl">
  <lm-tool-bar> </lm-tool-bar>
  <div class="panel">
    <div class="paper" [style.padding.px]="srv.padding">
      <div class="page-header">
        {{ srv.paperHeaderText }}
      </div>
      <div class="page-footer">
        {{ srv.paperFooterText }}
      </div>
      <div class="header" [style.height.px]="srv.headerHeight">
        <div class="area-mark" [style.left.px]="srv.markLeft">
          表头区
        </div>
        <lm-dnd-element>
          字段一
        </lm-dnd-element>
        <lm-dnd-element>
          字段二
        </lm-dnd-element>
        <lm-dnd-element>
          字段三
        </lm-dnd-element>
      </div>
      <div class="body">
        <div class="area-mark" [style.left.px]="srv.markLeft">
          表体区
        </div>
        <div cdkDropList cdkDropListOrientation="horizontal" class="table-header" (cdkDropListDropped)="drop($event)">
          <div class="table-header-item" *ngFor="let h of srv.formBodys" cdkDrag>{{ h.title }}</div>
        </div>
      </div>
      <div class="footer" [style.height.px]="srv.footerHeight">
        <div class="area-mark" [style.left.px]="srv.markLeft">
          表尾区
        </div>
      </div>
    </div>
  </div>
  <div class="toolpanel">
    <nz-tabset [nzTabPosition]="'top'" [nzType]="'card'">
      <nz-tab [nzTitle]="'基础配置'">
        <form nz-form nzLayout="vertical">
          <nz-form-item nzGutter="8">
            <nz-form-label nzRequired>打印对象</nz-form-label>
            <nz-form-control>
              <nz-select [(ngModel)]="srv.printObj" [ngModelOptions]="{ standalone: true }">
                <nz-option *ngFor="let p of srv.printObjs" [nzValue]="p" [nzLabel]="p.name"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzRequired>模板名称</nz-form-label>
            <nz-form-control>
              <input
                type="text"
                nz-input
                [(ngModel)]="srv.printName"
                [ngModelOptions]="{ standalone: true }"
                placeholder="请输入模板名称"
              />
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzRequired>纸张类型</nz-form-label>
            <nz-form-control>
              <nz-select [(ngModel)]="srv.paper" [ngModelOptions]="{ standalone: true }">
                <nz-option *ngFor="let p of srv.papers" [nzValue]="p" [nzLabel]="p.name"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>内边距</nz-form-label>
            <nz-form-control>
              <nz-col nzSpan="12">
                <nz-slider
                  [nzMin]="0"
                  [nzMax]="50"
                  [(ngModel)]="srv.padding"
                  [ngModelOptions]="{ standalone: true }"
                ></nz-slider>
              </nz-col>
              <div nz-col nzSpan="4">
                <nz-input-number
                  [ngModelOptions]="{ standalone: true }"
                  [nzMin]="0"
                  [nzMax]="50"
                  [ngStyle]="{ marginLeft: '16px' }"
                  [(ngModel)]="srv.padding"
                ></nz-input-number>
              </div>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>表头高度</nz-form-label>
            <nz-form-control>
              <nz-col nzSpan="12">
                <nz-slider
                  [nzMin]="0"
                  [nzMax]="374"
                  [(ngModel)]="srv.headerHeight"
                  [ngModelOptions]="{ standalone: true }"
                ></nz-slider>
              </nz-col>
              <div nz-col nzSpan="4">
                <nz-input-number
                  [ngModelOptions]="{ standalone: true }"
                  [nzMin]="0"
                  [nzMax]="374"
                  [ngStyle]="{ marginLeft: '16px' }"
                  [(ngModel)]="srv.headerHeight"
                ></nz-input-number>
              </div>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>表尾高度</nz-form-label>
            <nz-form-control>
              <nz-col nzSpan="12">
                <nz-slider
                  [nzMin]="0"
                  [nzMax]="374"
                  [(ngModel)]="srv.footerHeight"
                  [ngModelOptions]="{ standalone: true }"
                ></nz-slider>
              </nz-col>
              <div nz-col nzSpan="4">
                <nz-input-number
                  [ngModelOptions]="{ standalone: true }"
                  [nzMin]="0"
                  [nzMax]="374"
                  [ngStyle]="{ marginLeft: '16px' }"
                  [(ngModel)]="srv.footerHeight"
                ></nz-input-number>
              </div>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>页眉</nz-form-label>
            <nz-form-control>
              <nz-select [(ngModel)]="srv.paperHeader" [ngModelOptions]="{ standalone: true }">
                <nz-option *ngFor="let p of srv.paperHeaders" [nzValue]="p" [nzLabel]="p.name"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>页脚</nz-form-label>
            <nz-form-control>
              <nz-select [(ngModel)]="srv.paperFooter" [ngModelOptions]="{ standalone: true }">
                <nz-option *ngFor="let p of srv.paperFooters" [nzValue]="p" [nzLabel]="p.name"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>单据批量打印设置</nz-form-label>
            <nz-form-control>
              <label nz-checkbox [(ngModel)]="srv.isContinuousPrinting" [ngModelOptions]="{ standalone: true }"
                >连续打印（不换页打印）</label
              >
              <i
                nz-icon
                nzType="question-circle"
                nzTheme="outline"
                [nzTooltipTitle]="tplTip"
                nzTooltipPlacement="top"
                nz-tooltip
              ></i>
              <ng-template #tplTip>
                <p>连续打印，不换纸打印下一张订单；</p>
                <p>不连续打印，换纸打印下一张订单</p>
              </ng-template>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label>表头表尾</nz-form-label>
            <nz-form-control>
              <label nz-checkbox [(ngModel)]="srv.paginalHeader" [ngModelOptions]="{ standalone: true }"
                >每页打印表头</label
              >
              <br />
              <label nz-checkbox [(ngModel)]="srv.paginalFooter" [ngModelOptions]="{ standalone: true }"
                >每页打印表尾</label
              >
              <br />
              <label nz-checkbox [(ngModel)]="srv.fixedFooter" [ngModelOptions]="{ standalone: true }"
                >表尾锁定底部</label
              >
              <i
                nz-icon
                nzType="question-circle"
                nzTheme="outline"
                nzTooltipTitle="表尾始终在纸张底部。不开启，则表尾在打印内容结束后。"
                nzTooltipPlacement="top"
                nz-tooltip
              ></i>
            </nz-form-control>
          </nz-form-item>
        </form>
      </nz-tab>
      <nz-tab [nzTitle]="'数据源设置'">
        <nz-collapse [nzBordered]="false">
          <nz-collapse-panel nzHeader="表头字段">
            <ng-container *ngFor="let p of srv.formHeaders">
              <div class="collapse-checkbox">
                <label
                  class="collapse-checkbox"
                  nz-checkbox
                  [(ngModel)]="p.selected"
                  [ngModelOptions]="{ standalone: true }"
                  >{{ p.title }}</label
                >
                <input
                  *ngIf="p.type === 'input'"
                  nz-input
                  [(ngModel)]="p.value"
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
            </ng-container>
          </nz-collapse-panel>
          <nz-collapse-panel nzHeader="表体字段">
            <ng-container *ngFor="let p of srv.formBodys">
              <div class="collapse-checkbox">
                <label
                  nz-checkbox
                  [(ngModel)]="p.selected"
                  [nzDisabled]="p.disabled"
                  [ngModelOptions]="{ standalone: true }"
                  >{{ p.title }}</label
                >
              </div>
            </ng-container>
          </nz-collapse-panel>
          <nz-collapse-panel nzHeader="数据合计"> </nz-collapse-panel>
          <nz-collapse-panel nzHeader="表尾字段">
            <ng-container *ngFor="let p of srv.formFooter">
              <div class="collapse-checkbox">
                <label
                  class="collapse-checkbox"
                  nz-checkbox
                  [(ngModel)]="p.selected"
                  [nzDisabled]="p.disabled"
                  [ngModelOptions]="{ standalone: true }"
                  >{{ p.title }}</label
                >
                <input
                  *ngIf="p.type === 'custom'"
                  nz-input
                  [disabled]="!p.selected"
                  [(ngModel)]="p.value"
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
            </ng-container>
          </nz-collapse-panel>
          <nz-collapse-panel nzHeader="打印图片"> </nz-collapse-panel>
        </nz-collapse>
      </nz-tab>
    </nz-tabset>
  </div>
</div>
